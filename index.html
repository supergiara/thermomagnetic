<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Thermomagnetic Calculator</title>
<style>
    :root{ --card-w: 520px; }
    body {
        font-family: Inter, Arial, sans-serif;
        background: #f4f6f8;
        margin: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        padding: 24px;
    }
    .card {
        width: var(--card-w);
        max-width: calc(100% - 40px);
        background: #ffffff;
        border-radius: 12px;
        padding: 26px;
        box-shadow: 0 8px 30px rgba(15,23,42,0.08);
        text-align: center;
    }
    #logo {
        width: 220px;
        height: auto;
        margin: 6px auto 14px;
        display: block;
    }
    h1 { margin: 6px 0 18px; font-size: 20px; color:#0f1724; }
    .row { margin: 8px 0; }
    input[type="number"], select {
        width: 100%;
        box-sizing: border-box;
        padding: 12px 10px;
        font-size: 15px;
        border-radius: 8px;
        border: 1px solid #d1d5db;
        background: white;
        color: #0f1724;
    }
    button.calc {
        margin-top: 14px;
        background: #0b63c6;
        color: white;
        border: none;
        padding: 12px 18px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        width: 100%;
        font-size: 15px;
    }
    button.calc:hover { background:#094f9b; }
    .results {
        margin-top: 16px;
        display: grid;
        grid-template-columns: 1fr;
        gap: 10px;
    }
    .result {
        background: #f8fafc;
        border-radius: 8px;
        padding: 12px;
        font-weight: 700;
        color: #0f1724;
        text-align: left;
    }
    .label { font-weight:600; color:#334155; font-size:13px; margin-bottom:6px; display:block; }
</style>
</head>

<body>
<div class="card">
    <img id="logo" src="logo.png" alt="logo">
    <h1>Thermomagnetic Calculator</h1>

    <div class="row">
        <label class="label">Motor Power (kW)</label>
        <input id="power" type="number" step="0.1" placeholder="e.g. 7.5">
    </div>

    <div class="row">
        <label class="label">Voltage (V)</label>
        <input id="voltage" type="number" step="1" placeholder="e.g. 400">
    </div>

    <div class="row">
        <label class="label">Phases</label>
        <select id="phases">
            <option value="">Select phases…</option>
            <option value="1">1</option>
            <option value="3">3</option>
        </select>
    </div>

    <div class="row">
        <label class="label">Start type</label>
        <select id="start">
            <option value="">Select start…</option>
            <option value="DOL">DOL</option>
            <option value="StarDelta">Star-Delta</option>
            <option value="SoftStart">Soft Start</option>
        </select>
    </div>

    <button class="calc" onclick="calculate()">CALCULATE</button>

    <div class="results">
        <div class="result" id="avgAbs">Avg Absorption: — A</div>
        <div class="result" id="maxAbs">Max Absorption: — A</div>
        <div class="result" id="curveC">Thermomagnetic Curve C: —</div>
        <div class="result" id="curveD">Thermomagnetic Curve D: —</div>
    </div>
</div>

<script>
// Available breakers
const breakers = [6, 10, 16, 20, 25, 32, 40, 50];

// Generic function to compare target with F*multiplier (for G, I, K logic)
function pickFromDifferences(setValues, targetValue, multiplier=1) {
    for (let i = 0; i < setValues.length; i++) {
        const F = setValues[i];
        const colValue = F * multiplier;
        const diff = colValue - targetValue;
        if (diff >= 0) return F;
    }
    return setValues[setValues.length - 1];
}

function calculate() {
    // Read values
    const power = parseFloat(document.getElementById("power").value);
    const voltage = parseFloat(document.getElementById("voltage").value);
    const phasesVal = document.getElementById("phases").value;
    const start = document.getElementById("start").value;

    if (isNaN(power) || isNaN(voltage) || phasesVal === "" || start === "") {
        alert("Please fill all fields correctly.");
        return;
    }

    const phases = parseInt(phasesVal);

    // ---- AVG calculation (confirmed formula)
    const effFactor = (power < 5 ? 0.8 : 0.85);
    const phaseFactor = (phases === 3 ? Math.sqrt(3) : 1);

    let avg = power / (voltage * effFactor);
    avg = avg * 1000 / phaseFactor / 0.9;

    const roundedAvg = Math.round(avg);

    // ---- MAX absorption
    let maxAbs = (start === "DOL") ? roundedAvg * 7 : roundedAvg * 7 / 3;

    // ---- Thermomagnetic C and D logic
    const targetC = avg * 5;
    const targetD = avg * 10;

    const breakerAvg = pickFromDifferences(breakers, avg, 1);
    const breakerC = pickFromDifferences(breakers, targetC, 5);
    const breakerD = pickFromDifferences(breakers, targetD, 10);

    const finalC = Math.max(breakerAvg, breakerC);
    const finalD = Math.max(breakerAvg, breakerD);

    // ---- Output
    document.getElementById("avgAbs").innerText = "Avg Absorption: " + Math.round(avg) + " A";
    document.getElementById("maxAbs").innerText = "Max Absorption: " + Math.round(maxAbs) + " A";
    document.getElementById("curveC").innerText = "Thermomagnetic Curve C: C" + finalC;
    document.getElementById("curveD").innerText = "Thermomagnetic Curve D: D" + finalD;
}
</script>

</body>
</html>
