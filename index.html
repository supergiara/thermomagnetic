<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Thermomagnetic Calculator</title>
<style>
    body { font-family: Arial, sans-serif; text-align:center; background:#f5f5f5; padding:30px; }
    .container { max-width:480px; margin:auto; background:#fff; padding:24px; border-radius:12px; box-shadow:0 3px 14px rgba(0,0,0,0.12); }
    input, select { width:90%; padding:10px; margin:10px 0; border-radius:6px; border:1px solid #ccc; background:#fff8c6; font-size:16px; }
    button { padding:12px 24px; background:#1976d2; color:#fff; border:none; border-radius:8px; cursor:pointer; font-size:16px; }
    button:hover { background:#0f5598; }
    .result { background:#eee; padding:12px; border-radius:8px; margin-top:12px; font-weight:700; }
    #logo { width:140px; margin-bottom:14px; }
    small.note { display:block; margin-top:8px; color:#666; font-weight:400; }
</style>
</head>
<body>
<div class="container">
    <img id="logo" src="logo.png" alt="logo">
    <h2>Thermomagnetic Calculator</h2>

    <input id="power" type="number" step="0.1" placeholder="Motor Power (kW) (es. 7.5)">
    <input id="voltage" type="number" step="1" placeholder="Voltage (V) (es. 400)">

    <select id="phases">
        <option value="">Phases…</option>
        <option value="1">1 Phase</option>
        <option value="3">3 Phase</option>
    </select>

    <select id="start">
        <option value="">Start…</option>
        <option value="DOL">DOL</option>
        <option value="StarDelta">Star-Delta</option>
        <option value="SoftStart">Soft Start</option>
    </select>

    <button onclick="calculate()">CALCOLA</button>

    <div class="result" id="avgAbs">Avg Absorption: —</div>
    <div class="result" id="maxAbs">Max Absorption: —</div>
    <div class="result" id="curveC">Thermomagnetic Curve C: —</div>
    <div class="result" id="curveD">Thermomagnetic Curve D: —</div>

    <small class="note">I magnetotermici disponibili: 6,10,16,20,25,32,40,50</small>
</div>

<script>
// Tabella F del foglio Excel
const breakers = [6, 10, 16, 20, 25, 32, 40, 50];

// Restituisce il primo magnetotermico >= valore richiesto,
// oppure l'ultimo disponibile se nessuno è sufficientemente grande.
function pickBreakerAtLeast(value) {
    for (let b of breakers) {
        if (b >= value) return b;
    }
    return breakers[breakers.length - 1];
}

function calculate() {
    const power = parseFloat(document.getElementById("power").value);
    const voltage = parseFloat(document.getElementById("voltage").value);
    const phases = parseInt(document.getElementById("phases").value);
    const start = document.getElementById("start").value;

    if (!power || !voltage || !phases || !start) {
        alert("Riempi tutti i campi in giallo.");
        return;
    }

    // --- FORMULA AVG (esattamente come nel tuo Excel)
    // = A2 / ( B2 * SE(A2<5;0,8;0,85) ) *1000 / SE(C2=3;RADQ(3);1) / 0,9
    const effFactor = (power < 5 ? 0.8 : 0.85);
    const phaseFactor = (phases === 3 ? Math.sqrt(3) : 1);

    let avg
